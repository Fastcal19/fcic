<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quote / Project Table</title>
  <style>
    :root{
      --bg:#ffffff;
      --muted:#666;
      --accent:#ff7a00;
      --border:#e6e6e6;
      --header-bg:#fafafa;
      --radius:8px;
      --font: 14px/1.4 "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }
    html,body{height:100%;margin:0;background:var(--bg);font:var(--font)}
    .container{max-width:1100px;margin:28px auto;padding:18px;background:#fff;border:1px solid var(--border);border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.04)}
    h1{margin:0 0 12px;font-size:18px;color:#222}

    .table-wrap{overflow:auto;border-radius:8px;border:1px solid var(--border)}
    table{width:100%;border-collapse:collapse;min-width:900px}
    thead th{
      position:sticky;top:0;background:var(--header-bg);
      border-bottom:1px solid var(--border);
      padding:12px 10px;text-align:center;font-weight:600;color:#222;font-size:13px
    }
    tbody td{padding:10px 12px;border-bottom:1px solid var(--border);vertical-align:middle}
    colgroup col.c-1{width:10%}
    colgroup col.c-2{width:30%}
    colgroup col.c-3{width:5%}
    colgroup col.c-4{width:5%}
    colgroup col.c-5{width:10%}
    colgroup col.c-6{width:10%}
    colgroup col.c-7{width:12%}
    colgroup col.c-8{width:10%}
    colgroup col.c-9{width:8%}
    .text-right{text-align:right}
    .text-center{text-align:center}
    .muted{color:var(--muted);font-size:13px}
    a.link{color:var(--accent);text-decoration:none}
    a.link:hover{text-decoration:underline}
    @media (max-width:720px){
      :root{--font:13px/1.35 "Segoe UI", Roboto, Arial, sans-serif}
      table{min-width:760px}
      thead th{font-size:12px;padding:10px}
      tbody td{padding:8px}
    }
  </style>
</head>
<body>
  <div class="container" role="region" aria-label="Quote / Project Table">
    <h1>Quote / Project Table</h1>

    <div class="table-wrap">
      <table id="projectTable">
        <thead>
          <tr>
            <th class="text-center">ITEM DESCRIPTION</th>
            <th class="text-center">QTY</th>
            <th class="text-center">UNIT</th>
            <th class="text-center">UNIT_PRICE</th>
            <th class="text-center">AMOUNT</th>
            <th class="text-center">QUOTED_BY</th>
            <th class="text-center">REMARKS</th>
            <th class="text-center">URL LINK</th>
          </tr>
        </thead>
        <tbody id="projectBody">
          <tr><td colspan="8" class="text-center muted">Loading data...</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <script>
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxkAO0yVf5sHp67jrKMH3lg0jxB_PU1q9FsZFF6jFvtcfpHOf9192JKosJUkLGhiuAudA/exec"; // ← Replace with your own URL

    async function fetchProjectData() {
      const tbody = document.getElementById("projectBody");
      tbody.innerHTML = `<tr><td colspan="8" class="text-center muted">Fetching data...</td></tr>`;

      try {
        const res = await fetch(WEB_APP_URL);
        const data = await res.json();

        // ✅ If you only return project numbers, just display them:
        // (Modify if you later include costing details)
        if (Array.isArray(data) && data.length) {
          tbody.innerHTML = data.map(p => `
            <tr>
              <td colspan="8" class="text-center">${p}</td>
            </tr>
          `).join("");
        } else if (data.error) {
          tbody.innerHTML = `<tr><td colspan="8" class="text-center muted">Error: ${data.error}</td></tr>`;
        } else {
          tbody.innerHTML = `<tr><td colspan="8" class="text-center muted">No ongoing projects found.</td></tr>`;
        }

      } catch (err) {
        tbody.innerHTML = `<tr><td colspan="8" class="text-center muted">Error fetching data: ${err.message}</td></tr>`;
      }
    }

    fetchProjectData();
  </script>
</body>
</html>
